{% load static %}
<!doctype html>
<html lang="uz" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact — Asrorbek Azamov</title>
  <meta name="description" content="Contact Asrorbek Azamov — Student Leader, Researcher, and Social Innovator portfolio." />
  <style>
    :root{
      --bg:#05060a;
      --glass-1: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      --accent-1: #7ef9ff;
      --accent-2: #6b60ff;
      --muted: #9aa0b4;
      --card-radius: 14px;
      --fw-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--fw-sans);
      background: radial-gradient(1200px 700px at 10% 10%, rgba(110,90,255,0.06), transparent 10%),
                  radial-gradient(900px 500px at 90% 90%, rgba(126,249,255,0.03), transparent 10%),
                  var(--bg);
      color:#e6eef9;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden;
      line-height:1.45;
    }

    /* Canvas sits behind everything */
    #bg-canvas{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      z-index:0;
      display:block;
    }

    /* Header */
    .site-header{
      position:sticky;
      top:0;
      z-index:30;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:1rem;
      padding:14px 28px;
      backdrop-filter: blur(8px) saturate(120%);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-bottom: 1px solid rgba(255,255,255,0.03);
    }

    .brand{display:flex;align-items:center;gap:12px}
    .brand-mark{width:52px;height:52px;border-radius:8px;object-fit:cover;box-shadow:0 6px 20px rgba(0,0,0,0.6);}
    .name{margin:0;font-size:1rem;font-weight:700;letter-spacing:0.6px}
    .subtitle{margin:0;font-size:0.78rem;color:var(--muted)}

    .top-nav a{
      color:var(--muted);
      text-decoration:none;
      margin-left:18px;
      font-size:0.95rem;
    }
    .top-nav a:hover{color:var(--accent-1)}

    .panel{
      position:relative;
      z-index:2;
      padding:48px 6vw;
      min-height:36vh;
    }

    .glass{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      border-radius: var(--card-radius);
      padding:18px;
      box-shadow: 0 10px 30px rgba(10,14,28,0.6);
    }

    .contact-page {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    .hero-inner {
      text-align: center;
      max-width: 600px;
      margin: 0 auto;
    }

    .eyebrow{color:var(--muted);margin:0 0 10px;font-weight:600;font-size:0.9rem}
    .hero-title{margin:0 0 16px;font-size:2.1rem;line-height:1.05;letter-spacing:-0.6px}
    .lead{color: #cfe7ff; margin:0 0 18px}

    .btn{
      background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
      border: none;
      color:#041125;
      padding:10px 18px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 6px 30px rgba(107,96,255,0.14), inset 0 -2px 6px rgba(0,0,0,0.12);
      margin: 0 10px 10px 0;
    }

    .contact-actions {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
    }

    .contact-form-card {
      max-width: 500px;
      margin: 0 auto;
    }

    .form{
      display:grid;
      gap:12px;
      padding:16px;
      margin-top:12px;
    }

    .form label{
      display:flex;
      flex-direction:column;
      font-size:0.9rem;
      color:var(--muted);
    }

    input, textarea{
      background:transparent;
      border:1px solid rgba(255,255,255,0.04);
      padding:10px;
      border-radius:8px;
      color:inherit;
      min-width:0;
      margin-top: 5px;
    }

    .form-row{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content: space-between;
      margin-top: 10px;
    }

    .site-footer{
      text-align:center;
      padding:22px 6vw;
      color:var(--muted);
      border-top:1px solid rgba(255,255,255,0.02);
    }

    .contact-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .info-card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.03);
    }

    .info-card h4 {
      margin-top: 0;
      color: var(--accent-1);
    }

    /* Success Message Styles (index.html dagi kabi) */
    .success-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
      color: #041125;
      padding: 20px 30px;
      border-radius: 14px;
      font-weight: 700;
      box-shadow: 0 15px 40px rgba(0,0,0,0.5);
      z-index: 1000;
      text-align: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .success-message.show {
      opacity: 1;
    }

    @media (max-width:900px){
      .site-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
      .top-nav {
        width: 100%;
        display: flex;
        justify-content: space-between;
      }
      .top-nav a {
        margin-left: 0;
      }
      .hero-title {
        font-size: 1.8rem;
      }
    }

    @media (prefers-reduced-motion: reduce){
      *{transition:none!important;animation:none!important}
    }
  </style>
</head>
<body>
  <canvas id="bg-canvas" aria-hidden="true"></canvas>

  <header class="site-header" role="banner">
    <div class="brand">
      <img src="{% static 'images/f.svg' %}" alt="O'zbekiston bayrog'i" class="brand-mark" />
      <div>
        <h1 class="name">Asrorbek Azamov</h1>
        <p class="subtitle">STUDENT LEADER & SOCIAL INNOVATOR</p>
      </div>
    </div>
    <nav class="top-nav" role="navigation" aria-label="Main">
      <a href="{% url 'index' %}">Home</a>
      <a href="{% url 'about' %}">About</a>
      <a href="{% url 'research' %}">Projects</a>
      <a href="{% url 'contact' %}">Contact</a>
    </nav>
  </header>

  <main id="main" role="main">
    <section class="panel contact-page">
      <div class="hero-inner">
        <h2 class="eyebrow">Get in Touch</h2>
        <h3 class="hero-title">Let's collaborate on education, environmental, or youth development projects.</h3>
        <p class="lead">Fill out the form below or download my CV to learn more about my work and achievements.</p>
      </div>

      <div class="contact-actions">
        <button id="download-cv" class="btn">Download my CV</button>

        <button id="email-me" class="btn">Email Me</button>

        <button id="call-me" class="btn">Call Me</button>
      </div>

      <div class="contact-info">
        <div class="info-card">
          <h4>Phone</h4>
          <p>+998 91 129 14 40</p>
        </div>
        <div class="info-card">
          <h4>Gmail</h4>
          <p>aazamov621@gmail.com</p>
        </div>
        <div class="info-card">
          <h4>School</h4>
          <p>Registan Private School</p>
        </div>
      </div>

      <div class="glass card contact-form-card">
        <form id="msg-form" class="form" aria-label="Contact form" method="POST" action="{% url 'contact' %}">
          {% csrf_token %}
          <label>
            <span>Name</span>
            <input type="text" name="name" required placeholder="Your name" />
          </label>
          <label>
            <span>Email</span>
            <input type="email" name="email" required placeholder="Your email address" />
          </label>
          <label>
            <span>Message</span>
            <textarea name="message" rows="4" required placeholder="Your message"></textarea>
          </label>
          <div class="form-row">
            <button type="submit" class="btn">Send Message</button>
            <div id="form-status" aria-live="polite" style="color:var(--accent-1);font-size:0.9rem"></div>
          </div>
        </form>
      </div>
    </section>
  </main>

  <!-- Success Message (index.html dagi kabi) -->
  <div id="success-message" class="success-message">
    Message sent successfully! We'll contact you soon.
  </div>

  <footer class="site-footer" role="contentinfo">
    <small>© <time id="year"></time> Asrorbek Azamov — Student Leader Portfolio</small>
  </footer>

  <script>
    // Set current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Download CV functionality
    document.getElementById('download-cv').addEventListener('click', () => {
      const a = document.createElement('a');
      a.href = "{% static 'cv.pdf' %}"; // Your CV file path
      a.download = "Asrorbek_Azamov_CV.pdf"; // File name for download
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // Email functionality
    document.getElementById('email-me').addEventListener('click', function() {
      window.location.href = "mailto:your.email@example.com"; // Replace with your email
    });

    // Call functionality
    document.getElementById('call-me').addEventListener('click', function() {
      window.location.href = "tel:+998911291440";
    });

    // AJAX POST for Contact Form - YANGILANGAN VERSIYA
    const form = document.getElementById('msg-form');
    const status = document.getElementById('form-status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      const submitButton = form.querySelector('button[type="submit"]');
      const originalButtonText = submitButton.textContent;

      // Disable button and show loading state
      submitButton.disabled = true;
      submitButton.textContent = 'Sending...';

      try {
        const response = await fetch(form.action, {
          method: 'POST',
          headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
          },
          body: formData
        });

        const data = await response.json();

        if(data.status === 'success'){
          // Show success message (index.html dagi kabi)
          const successMessage = document.getElementById('success-message');
          successMessage.textContent = `Sent successfully! Thanks, ${data.name}. I'll contact you soon`;
          successMessage.classList.add('show');

          // Reset form
          form.reset();

          // Hide success message after 3 seconds
          setTimeout(() => {
            successMessage.classList.remove('show');
          }, 3000);
        } else {
          // Error handling
          let errorText = 'Error: please try again.';
          if (data.errors) {
            errorText = 'Please check your input and try again.';
          }
          status.textContent = errorText;
        }
      } catch(err){
        status.textContent = 'Server error — please try again later.';
        console.error(err);
      } finally {
        // Re-enable button
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
      }
    });
  </script>
</body>
</html>